<!DOCTYPE html>
<html>
<head>
<title>Javier Gomez: TF2 Sentry Gun</title>
<link rel="icon" type="image/png" href="pictures/fav-icon.png">
</head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="w3.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">


<!-------Navbar Section------->
<div class="w3-bar w3-black w3-text-white">
	<a href="index.html" class="w3-bar-item w3-button w3-left"><img class="navbar-logo" src="pictures/logo.png"></a>
	<div class="w3-dropdown-click w3-right">
		<button class="w3-button w3-padding-16 w3-hide-small" onclick="myFunction2()">&#9776;</button>
		<div id="demo2" class="w3-dropdown-content w3-bar-block" style="right: 0px;">
			<a href="high_school.html" class="w3-bar-item w3-button">High School</a>
			<a href="personal_achievements.html" class="w3-bar-item w3-button">Personal Achievements</a>
			<a href="youtube.html" class="w3-bar-item w3-button">YouTube</a>
		</div>
	</div>
	<a href="career.html" class="w3-bar-item w3-button w3-padding-16 w3-right w3-hide-small">Career</a>
	<a href="personal_projects.html" class="w3-bar-item w3-button w3-padding-16 w3-right w3-hide-small">Projects</a>
	<a href="college_clubs.html" class="w3-bar-item w3-button w3-padding-16 w3-right w3-hide-small">Clubs</a>
	<a href="index.html" class="w3-bar-item w3-button w3-padding-16 w3-right w3-hide-small">Home</a>
	<a href="javascript:void(0)" class="w3-bar-item w3-button w3-padding-16 w3-right w3-hide-large w3-hide-medium" onclick="myFunction()">&#9776;</a>
</div>
<div id="demo" class="w3-bar-block w3-white w3-hide w3-hide-large w3-hide-medium w3-animate-top">
	<a href="index.html" class="w3-bar-item w3-button">Home</a>
	<a href="college_clubs.html" class="w3-bar-item w3-button">College Clubs</a>
	<a href="personal_projects.html" class="w3-bar-item w3-button">Projects</a>
	<a href="career.html" class="w3-bar-item w3-button">Career</a>
	<a href="high_school.html" class="w3-bar-item w3-button">High School</a>
	<a href="personal_achievements.html" class="w3-bar-item w3-button">Personal Achievements</a>
	<a href="youtube.html" class="w3-bar-item w3-button">YouTube</a>
</div>

<!-------Header------->
<div class="w3-light-grey">
	<div class="w3-content w3-container" style="max-width:1200px; padding-top: 90px; padding-bottom: 90px;">
		<h1 class="w3-center"><a class="text-ref" href="index.html">Home</a><i class="material-icons">arrow_forward</i><a href="personal_projects.html" class="text-ref">Personal Projects</a><i class="material-icons">arrow_forward</i><a class="text-ref" href="tf2_sentry_gun.html">TF2 Sentry Gun</a></h1>
	</div>
</div>

<!-------Content------->
<div class="w3-container w3-content" style="max-width: 850px; padding-top: 25px;">
	<div class="w3-row">
		<div class="w3-col l12 m12 s12">
			<img class="image-gal" style="max-width: 100%;" src="pictures/sentry_gun/demonstration_vid.gif">
		</div>
	</div>

	<div class="content-padding">
		<p>Let's get one thing straight...I've played way too much Team Fortress 2 (TF2). I guess you can say I love this game. One of the playable characters is the Engineer, who is able to make the iconic sentry gun. The sentry gun's purpose is to automatically track and shoot enemies if they're within the field of range of the gun. If there is no enemy, the sentry gun scans back and forth until an enemy comes into view. Many dweebs (myself included) have been inspired by the possibility of making this virtual object into a working reality. My rendition of the sentry gun excludes the tracking and shooting portion and only scans back and forth while making the iconic sounds. I wanted to make a sentry gun that could fit on my desk and move like in the game.</p>
	</div>

	<div class="content-padding">
		<h1>How It Works</h1>
		<p>The desktop sentry gun works by plugging in the attached USB cable to a 5V USB adapter. This will power the sentry gun. Make sure that the sentry gun's "head" is aligned prior to plugging in the cable. The program references this initial position as the equidistant point for its operation. And done!</p>
		<p>If you want to stop operation of the sentry gun, press the button prior to unplugging it. This will cause the sentry gun to go back to its center position and hold that position for ~6 seconds. Once it's stationary, you can unplug the USB cable.</p>
		<iframe width="100%" height="479" src="https://www.youtube.com/embed/dPrOoYUjC_o"allowfullscreen></iframe>
	</div>

	<div class="content-padding">
		<h1>Design</h1>
		<p>The design was created by importing .STL files of pre-existing TF2 sentry guns into Fusion 360 and scaling everything until one of the 28BYJ-48 ULN2003 stepper motors could fit within the main body of the sentry gun. Since most of the parts did not need to be modified, the original files were scaled and printed without modifications. The main body of the sentry gun, the holding piece, and the middle shaft were created from scratch to accommodate the stepper motor needed to motorize the sentry gun. Luckily the printers at the MakerSpace at UCLA are good at handling odd geometries so I didn't have to think too much about the "printability" of the parts I created. The case for the electronics was rather simple as there was plenty of space for the electronics, however, I added snap fit connections so the two base parts are easy to remove.</p>
		<model-viewer src="files/sentry_gun/Sentry Gun.glb" shadow-intensity="2" auto-rotate camera-controls camera-orbit="135deg 50deg" interaction-policy="allow-when-focused" interaction-prompt="none" style="background-color: #f1f1f1; height: 500px;"></model-viewer>
		<p>Download the files on my <a href="https://www.thingiverse.com/thing:4751522" target="_blank">Thingiverse website</a>.</p>
	</div>

	<div class="content-padding">
		<h1>Electronics</h1>
		<div class="w3-row">
			<div class="w3-col s12">
				<img class="image-gal" style="max-width: 100%;" src="pictures/sentry_gun/electronics.JPG">
			</div>
		</div>
		<p>The electronics section can be simplified into 4 different sections that interface with the microcontroller (Arduino Nano in this case).</p>
		<h3>1) Micro SD Card Module</h3>
		<p>Interfaces a micro SD card with the Nano. The audio file is stored and accessed in the micro SD card. The audio file must be converted to a .WAV with 8 bit resolution, 16000 Hz sampling rate, and mono audio channels. Use <a href="https://audio.online-convert.com/convert-to-wav" target="_blank">this website</a> to convert audio files to the appropriate .WAV format.</p>
		<h3>2) Stepper Motor</h3>
		<p>This project uses a 28BYJ-48 stepper motor, a small four phase stepper motor that operates on common 5V.  The motor comes with a ULN2003 driver board to simplify the circuitry to the stepper motor itself. The code provided operates the sentry gun in full stepping as opposed to half stepping. Full stepping energizes one of the four phases at a given time whereas half stepping energizes two phases at a given time. Half stepping essentially doubles the amount of steps needed for a whole rotation but increases torque. Since torque doesn't matter for this application, full stepping was selected.</p>
		<h3>3) Amplification and Audio</h3>
		<p>In order to drive a simple 0.5W 8&#8486; speaker, the common LM386 OP-Amp was used. Since a speaker is essentially a generator, direct operation of the speaker to the Nano could cause damage as a reverse current can be generated by the speaker. The LM386 amplifies the digital PWM signals created by the Nano to amplify the sound coming from the speaker. A 10&micro;F capacitor across pins 1 and 8 of the LM386 amplifies the signal by 200. Without it, an amplification of 20 is achieved. Within the code, the Nano is only able to achieve an arbitrary "volume" of 4 out of a max of 7.</p>
		<h3>4) Push Button</h3>
		<p>This aspect of the project is simple. Simply ground the button on the same side as the probing pin and provide a 5V supply on the other side of the button. When the button is pressed, the 5V side will flow towards the probing pin rather than through the resistor, indicating the button has been pressed.</p>
		<div class="w3-row">
			<div class="w3-col s12">
				<img class="image-gal" style="max-width: 100%;" src="pictures/sentry_gun/schematic.png">
			</div>
		</div>
	</div>

	<div class="content-padding">
		<h1>Code</h1>
		<p>Download the following libraries for the code to function:</p>
		<ul>
			<li><a href="files/sentry_gun/AccelStepper.zip" download>AccelStepper</a></li>
			<li><a href="files/sentry_gun/TMRpcm-master.zip" download>TMRpcm</a></li>
		</ul>
		<script src="https://gist.github.com/Xavi009/e4e1167599049004d3fc921adfdc6531.js"></script>
		<p>Access the GitHub <a href="https://github.com/Xavi009/tf2_sentry_gun_code" target="_blank"><b>here</b></a>.</p>
	</div>
	
	<div class="content-padding">
		<h1>Context and Struggles</h1>
		<p>Going into my first year of college, I had some experience with 3D printing and Arduino from self-exploration in high school, but not really that much. At one point in my first year, I got tired of not making anything and UCLA had really high-quality printers. So naturally, I started modelling the sentry gun and 3D printing the prototypes. I used pre-existing .STL models available online as a template, but I modified mine to be able to fit the electronics I wanted. The 3D printing prototype process was not new to me so this was easy. It was the electronics that gave me a hard time.</p>
		<p>This project had a lot of firsts for me. I learned how to shrink my projects using Arduino Nanos instead of Unos. I also learned about OP-Amps and how to integrate speakers into projects. Because I had no textbook knowledge of OP-Amps, this part was extremely difficult for me. This mainly had to do with the fact that I was really hesitant to buy electronic parts in bulk. Specifically, I needed a range of capacitors to operate the OP-Amp, but I just stuck to use one specific large catalytic capacitor. You might laugh since OP-Amps are basically operated on capacitors, but how the hell was I supposed to know back then?</p>
		<p>Another difficulty was the speaker. The speaker caused me all sorts of problems. The SD card has to be formatted, the audio file also has to be formatted, the concept of OP-Amp operation, and the code to create digital PWM signals was difficult to understand. There were so many variables I didn't fully understand which complicated and lengthened the amount of time spent creating this project. But now I know what to expect when doing audio-based projects, so that's cool.</p>
	</div>
</div>


<!--Navbar Script-->
<script>
function myFunction() {
  var x = document.getElementById("demo");
  if (x.className.indexOf("w3-show") == -1) {
    x.className += " w3-show";
  } else { 
    x.className = x.className.replace(" w3-show", "");
  }
}
function myFunction2() {
  var x = document.getElementById("demo2");
  if (x.className.indexOf("w3-show") == -1) {
    x.className += " w3-show";
  } else { 
    x.className = x.className.replace(" w3-show", "");
  }
}
</script>
<!--Model Viewer-->
<script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>
<script nomodule src="https://unpkg.com/@google/model-viewer/dist/model-viewer-legacy.js"></script>
</html>